<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div id="app"></div>

    <script type="module">
        import {
            h,
            render,
            createRenderer
        } from '../../../node_modules/vue/dist/vue.esm-browser.js';
        // import { h } from '';

        /** 
         * vue通过渲染器将虚拟节点渲染到真实DOM中
         * vnode => render => 真实DOM
         */
        const vnode = h('div', {
            id: 'main',
            style: {
                color: 'red',
                fontSize: '20px'
            }
        }, 'Hello, Vue 3!');

        /**
         * runtime-core包中提供了核心渲染逻辑，依赖响应式模块儿 reactivity
         * 
         * runtime-dom包中提供了createRenderer方法，用于创建渲染器，依赖runtime-core包
         *
         * vue包导出了 runtime-dom
         */
        const renderer = createRenderer({
            patchProp(el, key, prevValue, nextValue) {

            },
            // 插入节点
            insert(el, parent, anchor) {
                // insertBefore第二个参数为null，等价于 parent.appendChild(el);
                parent.insertBefore(el, anchor || null);
            },
            // 创建元素
            createElement(tag) {
                return document.createElement(tag);
            },
            // 设置元素文本内容
            setElementText(el, text) {
                el.textContent = text;
            },
            // 创建文本节点
            createText(el, text) {
                return document.createTextNode(text);
            },
            // 设置文本节点内容
            setText(node, text) {
                node.nodeValue = text;
            },
            // 获取父节点
            parentNode(el) {
                return el.parentNode;
            },
            // 获取下一个兄弟节点
            nextSibling(el) {
                return el.nextSibling;
            },
            // 查询选择器
            querySelector(selector) {
                return document.querySelector(selector);
            },
            // 移除节点
            remove(el) {
                const parent = el.parentNode;
                if (parent) {
                    parent.removeChild(el);
                }
            }
        });

        console.log(renderer);

        renderer.render(vnode, document.getElementById('app'));

        // setTimeout(() => {
        //     renderer.render(null, document.getElementById('app'));
        // }, 2000);

    </script>
</body>

</html>